var Ar=Object.defineProperty;var Sr=(t,i,a)=>i in t?Ar(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a;var De=(t,i,a)=>(Sr(t,typeof i!="symbol"?i+"":i,a),a);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const h of s)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function a(s){const h={};return s.integrity&&(h.integrity=s.integrity),s.referrerPolicy&&(h.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?h.credentials="include":s.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(s){if(s.ep)return;s.ep=!0;const h=a(s);fetch(s.href,h)}})();const L=20;var A=(t=>(t[t.up=0]="up",t[t.right=1]="right",t[t.down=2]="down",t[t.left=3]="left",t))(A||{}),E=(t=>(t.top="top",t.right="right",t.bottom="bottom",t.left="left",t))(E||{}),k=(t=>(t[t.finished=0]="finished",t[t.playing=1]="playing",t[t.paused=2]="paused",t))(k||{});const Rt=(t,i)=>Math.round(Math.random()*(i-t))+t,ot=(t=400,i=300,a)=>{const o=a??document.createElement("canvas");o.style.width=`${t}px`,o.style.height=`${i}px`;const s=window.devicePixelRatio??1;return o.width=Math.floor(s*t),o.height=Math.floor(s*i),o.getContext("2d").scale(s,s),o},Ue=({x:t,y:i},{x:a,y:o})=>{if(t===a){if(i-o===1)return E.bottom;if(i-o===-1)return E.top;if(i-o<-1)return E.bottom;if(i-o>1)return E.top}if(i===o){if(t-a===1)return E.right;if(t-a===-1)return E.left;if(t-a<-1)return E.right;if(t-a>1)return E.left}return E.right},ne=(t,i,a,o)=>t===E.top&&i===E.bottom?null:t===E.top&&i===E.right?{x:a.x,y:o.y}:t===E.top&&i===E.left?{x:a.x,y:o.y}:t===E.bottom&&i===E.top?null:t===E.bottom&&i===E.right?{x:a.x,y:o.y}:t===E.bottom&&i===E.left?{x:a.x,y:o.y}:t===E.left&&i===E.top?{x:o.x,y:a.y}:t===E.left&&i===E.right?null:t===E.left&&i===E.bottom?{x:o.x,y:a.y}:t===E.right&&i===E.top?{x:o.x,y:a.y}:t===E.right&&i===E.bottom?{x:o.x,y:a.y}:(t===E.right&&i===E.left,null),Nr=(t,i,a,o,s,h)=>{t.save(),t.translate(i,a),t.beginPath(),t.moveTo(0,h),t.quadraticCurveTo(0,0,h,0),t.lineTo(o-h,0),t.quadraticCurveTo(o,0,o,h),t.lineTo(o,s-h),t.quadraticCurveTo(o,s,o-h,s),t.lineTo(h,s),t.quadraticCurveTo(0,s,0,s-h),t.closePath(),t.restore()};var He=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ut(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ht={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(i,a,o,s){var h=["","webkit","Moz","MS","ms","o"],p=a.createElement("div"),T="function",u=Math.round,m=Math.abs,O=Date.now;function I(e,r,n){return setTimeout(he(e,n),r)}function C(e,r,n){return Array.isArray(e)?(_(e,n[r],n),!0):!1}function _(e,r,n){var l;if(e)if(e.forEach)e.forEach(r,n);else if(e.length!==s)for(l=0;l<e.length;)r.call(n,e[l],l,e),l++;else for(l in e)e.hasOwnProperty(l)&&r.call(n,e[l],l,e)}function v(e,r,n){var l="DEPRECATED METHOD: "+r+`
`+n+` AT 
`;return function(){var c=new Error("get-stack-trace"),d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",M=i.console&&(i.console.warn||i.console.log);return M&&M.call(i.console,l,d),e.apply(this,arguments)}}var f;typeof Object.assign!="function"?f=function(r){if(r===s||r===null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(r),l=1;l<arguments.length;l++){var c=arguments[l];if(c!==s&&c!==null)for(var d in c)c.hasOwnProperty(d)&&(n[d]=c[d])}return n}:f=Object.assign;var N=v(function(r,n,l){for(var c=Object.keys(n),d=0;d<c.length;)(!l||l&&r[c[d]]===s)&&(r[c[d]]=n[c[d]]),d++;return r},"extend","Use `assign`."),w=v(function(r,n){return N(r,n,!0)},"merge","Use `assign`.");function U(e,r,n){var l=r.prototype,c;c=e.prototype=Object.create(l),c.constructor=e,c._super=l,n&&f(c,n)}function he(e,r){return function(){return e.apply(r,arguments)}}function ce(e,r){return typeof e==T?e.apply(r&&r[0]||s,r):e}function S(e,r){return e===s?r:e}function b(e,r,n){_(R(r),function(l){e.addEventListener(l,n,!1)})}function y(e,r,n){_(R(r),function(l){e.removeEventListener(l,n,!1)})}function g(e,r){for(;e;){if(e==r)return!0;e=e.parentNode}return!1}function P(e,r){return e.indexOf(r)>-1}function R(e){return e.trim().split(/\s+/g)}function $(e,r,n){if(e.indexOf&&!n)return e.indexOf(r);for(var l=0;l<e.length;){if(n&&e[l][n]==r||!n&&e[l]===r)return l;l++}return-1}function W(e){return Array.prototype.slice.call(e,0)}function H(e,r,n){for(var l=[],c=[],d=0;d<e.length;){var M=r?e[d][r]:e[d];$(c,M)<0&&l.push(e[d]),c[d]=M,d++}return n&&(r?l=l.sort(function(Y,X){return Y[r]>X[r]}):l=l.sort()),l}function B(e,r){for(var n,l,c=r[0].toUpperCase()+r.slice(1),d=0;d<h.length;){if(n=h[d],l=n?n+c:r,l in e)return l;d++}return s}var G=1;function jt(){return G++}function ct(e){var r=e.ownerDocument||e;return r.defaultView||r.parentWindow||i}var xt=/mobile|tablet|ip(ad|hone|od)|android/i,ut="ontouchstart"in i,Zt=B(i,"PointerEvent")!==s,Jt=ut&&xt.test(navigator.userAgent),pe="touch",Qt="pen",ze="mouse",Kt="kinect",er=25,q=1,se=2,D=4,z=8,_e=1,ve=2,ge=4,Te=8,ye=16,Z=ve|ge,ae=Te|ye,ft=Z|ae,dt=["x","y"],Me=["clientX","clientY"];function V(e,r){var n=this;this.manager=e,this.callback=r,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(l){ce(e.options.enable,[e])&&n.handler(l)},this.init()}V.prototype={handler:function(){},init:function(){this.evEl&&b(this.element,this.evEl,this.domHandler),this.evTarget&&b(this.target,this.evTarget,this.domHandler),this.evWin&&b(ct(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&y(this.element,this.evEl,this.domHandler),this.evTarget&&y(this.target,this.evTarget,this.domHandler),this.evWin&&y(ct(this.element),this.evWin,this.domHandler)}};function tr(e){var r,n=e.options.inputClass;return n?r=n:Zt?r=Ge:Jt?r=Se:ut?r=Ve:r=Ae,new r(e,rr)}function rr(e,r,n){var l=n.pointers.length,c=n.changedPointers.length,d=r&q&&l-c===0,M=r&(D|z)&&l-c===0;n.isFirst=!!d,n.isFinal=!!M,d&&(e.session={}),n.eventType=r,nr(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function nr(e,r){var n=e.session,l=r.pointers,c=l.length;n.firstInput||(n.firstInput=mt(r)),c>1&&!n.firstMultiple?n.firstMultiple=mt(r):c===1&&(n.firstMultiple=!1);var d=n.firstInput,M=n.firstMultiple,F=M?M.center:d.center,Y=r.center=pt(l);r.timeStamp=O(),r.deltaTime=r.timeStamp-d.timeStamp,r.angle=Be(F,Y),r.distance=we(F,Y),ir(n,r),r.offsetDirection=gt(r.deltaX,r.deltaY);var X=vt(r.deltaTime,r.deltaX,r.deltaY);r.overallVelocityX=X.x,r.overallVelocityY=X.y,r.overallVelocity=m(X.x)>m(X.y)?X.x:X.y,r.scale=M?or(M.pointers,l):1,r.rotation=M?ar(M.pointers,l):0,r.maxPointers=n.prevInput?r.pointers.length>n.prevInput.maxPointers?r.pointers.length:n.prevInput.maxPointers:r.pointers.length,sr(n,r);var Q=e.element;g(r.srcEvent.target,Q)&&(Q=r.srcEvent.target),r.target=Q}function ir(e,r){var n=r.center,l=e.offsetDelta||{},c=e.prevDelta||{},d=e.prevInput||{};(r.eventType===q||d.eventType===D)&&(c=e.prevDelta={x:d.deltaX||0,y:d.deltaY||0},l=e.offsetDelta={x:n.x,y:n.y}),r.deltaX=c.x+(n.x-l.x),r.deltaY=c.y+(n.y-l.y)}function sr(e,r){var n=e.lastInterval||r,l=r.timeStamp-n.timeStamp,c,d,M,F;if(r.eventType!=z&&(l>er||n.velocity===s)){var Y=r.deltaX-n.deltaX,X=r.deltaY-n.deltaY,Q=vt(l,Y,X);d=Q.x,M=Q.y,c=m(Q.x)>m(Q.y)?Q.x:Q.y,F=gt(Y,X),e.lastInterval=r}else c=n.velocity,d=n.velocityX,M=n.velocityY,F=n.direction;r.velocity=c,r.velocityX=d,r.velocityY=M,r.direction=F}function mt(e){for(var r=[],n=0;n<e.pointers.length;)r[n]={clientX:u(e.pointers[n].clientX),clientY:u(e.pointers[n].clientY)},n++;return{timeStamp:O(),pointers:r,center:pt(r),deltaX:e.deltaX,deltaY:e.deltaY}}function pt(e){var r=e.length;if(r===1)return{x:u(e[0].clientX),y:u(e[0].clientY)};for(var n=0,l=0,c=0;c<r;)n+=e[c].clientX,l+=e[c].clientY,c++;return{x:u(n/r),y:u(l/r)}}function vt(e,r,n){return{x:r/e||0,y:n/e||0}}function gt(e,r){return e===r?_e:m(e)>=m(r)?e<0?ve:ge:r<0?Te:ye}function we(e,r,n){n||(n=dt);var l=r[n[0]]-e[n[0]],c=r[n[1]]-e[n[1]];return Math.sqrt(l*l+c*c)}function Be(e,r,n){n||(n=dt);var l=r[n[0]]-e[n[0]],c=r[n[1]]-e[n[1]];return Math.atan2(c,l)*180/Math.PI}function ar(e,r){return Be(r[1],r[0],Me)+Be(e[1],e[0],Me)}function or(e,r){return we(r[0],r[1],Me)/we(e[0],e[1],Me)}var lr={mousedown:q,mousemove:se,mouseup:D},hr="mousedown",cr="mousemove mouseup";function Ae(){this.evEl=hr,this.evWin=cr,this.pressed=!1,V.apply(this,arguments)}U(Ae,V,{handler:function(r){var n=lr[r.type];n&q&&r.button===0&&(this.pressed=!0),n&se&&r.which!==1&&(n=D),this.pressed&&(n&D&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[r],changedPointers:[r],pointerType:ze,srcEvent:r}))}});var ur={pointerdown:q,pointermove:se,pointerup:D,pointercancel:z,pointerout:z},fr={2:pe,3:Qt,4:ze,5:Kt},Tt="pointerdown",yt="pointermove pointerup pointercancel";i.MSPointerEvent&&!i.PointerEvent&&(Tt="MSPointerDown",yt="MSPointerMove MSPointerUp MSPointerCancel");function Ge(){this.evEl=Tt,this.evWin=yt,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}U(Ge,V,{handler:function(r){var n=this.store,l=!1,c=r.type.toLowerCase().replace("ms",""),d=ur[c],M=fr[r.pointerType]||r.pointerType,F=M==pe,Y=$(n,r.pointerId,"pointerId");d&q&&(r.button===0||F)?Y<0&&(n.push(r),Y=n.length-1):d&(D|z)&&(l=!0),!(Y<0)&&(n[Y]=r,this.callback(this.manager,d,{pointers:n,changedPointers:[r],pointerType:M,srcEvent:r}),l&&n.splice(Y,1))}});var dr={touchstart:q,touchmove:se,touchend:D,touchcancel:z},mr="touchstart",pr="touchstart touchmove touchend touchcancel";function Et(){this.evTarget=mr,this.evWin=pr,this.started=!1,V.apply(this,arguments)}U(Et,V,{handler:function(r){var n=dr[r.type];if(n===q&&(this.started=!0),!!this.started){var l=vr.call(this,r,n);n&(D|z)&&l[0].length-l[1].length===0&&(this.started=!1),this.callback(this.manager,n,{pointers:l[0],changedPointers:l[1],pointerType:pe,srcEvent:r})}}});function vr(e,r){var n=W(e.touches),l=W(e.changedTouches);return r&(D|z)&&(n=H(n.concat(l),"identifier",!0)),[n,l]}var gr={touchstart:q,touchmove:se,touchend:D,touchcancel:z},Tr="touchstart touchmove touchend touchcancel";function Se(){this.evTarget=Tr,this.targetIds={},V.apply(this,arguments)}U(Se,V,{handler:function(r){var n=gr[r.type],l=yr.call(this,r,n);l&&this.callback(this.manager,n,{pointers:l[0],changedPointers:l[1],pointerType:pe,srcEvent:r})}});function yr(e,r){var n=W(e.touches),l=this.targetIds;if(r&(q|se)&&n.length===1)return l[n[0].identifier]=!0,[n,n];var c,d,M=W(e.changedTouches),F=[],Y=this.target;if(d=n.filter(function(X){return g(X.target,Y)}),r===q)for(c=0;c<d.length;)l[d[c].identifier]=!0,c++;for(c=0;c<M.length;)l[M[c].identifier]&&F.push(M[c]),r&(D|z)&&delete l[M[c].identifier],c++;if(F.length)return[H(d.concat(F),"identifier",!0),F]}var Er=2500,bt=25;function Ve(){V.apply(this,arguments);var e=he(this.handler,this);this.touch=new Se(this.manager,e),this.mouse=new Ae(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}U(Ve,V,{handler:function(r,n,l){var c=l.pointerType==pe,d=l.pointerType==ze;if(!(d&&l.sourceCapabilities&&l.sourceCapabilities.firesTouchEvents)){if(c)br.call(this,n,l);else if(d&&Ir.call(this,l))return;this.callback(r,n,l)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function br(e,r){e&q?(this.primaryTouch=r.changedPointers[0].identifier,It.call(this,r)):e&(D|z)&&It.call(this,r)}function It(e){var r=e.changedPointers[0];if(r.identifier===this.primaryTouch){var n={x:r.clientX,y:r.clientY};this.lastTouches.push(n);var l=this.lastTouches,c=function(){var d=l.indexOf(n);d>-1&&l.splice(d,1)};setTimeout(c,Er)}}function Ir(e){for(var r=e.srcEvent.clientX,n=e.srcEvent.clientY,l=0;l<this.lastTouches.length;l++){var c=this.lastTouches[l],d=Math.abs(r-c.x),M=Math.abs(n-c.y);if(d<=bt&&M<=bt)return!0}return!1}var Ct=B(p.style,"touchAction"),Pt=Ct!==s,_t="compute",Mt="auto",je="manipulation",oe="none",Ee="pan-x",be="pan-y",Ne=Pr();function xe(e,r){this.manager=e,this.set(r)}xe.prototype={set:function(e){e==_t&&(e=this.compute()),Pt&&this.manager.element.style&&Ne[e]&&(this.manager.element.style[Ct]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return _(this.manager.recognizers,function(r){ce(r.options.enable,[r])&&(e=e.concat(r.getTouchAction()))}),Cr(e.join(" "))},preventDefaults:function(e){var r=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented){r.preventDefault();return}var l=this.actions,c=P(l,oe)&&!Ne[oe],d=P(l,be)&&!Ne[be],M=P(l,Ee)&&!Ne[Ee];if(c){var F=e.pointers.length===1,Y=e.distance<2,X=e.deltaTime<250;if(F&&Y&&X)return}if(!(M&&d)&&(c||d&&n&Z||M&&n&ae))return this.preventSrc(r)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};function Cr(e){if(P(e,oe))return oe;var r=P(e,Ee),n=P(e,be);return r&&n?oe:r||n?r?Ee:be:P(e,je)?je:Mt}function Pr(){if(!Pt)return!1;var e={},r=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=r?i.CSS.supports("touch-action",n):!0}),e}var Re=1,j=2,ue=4,re=8,K=re,Ie=16,J=32;function ee(e){this.options=f({},this.defaults,e||{}),this.id=jt(),this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=Re,this.simultaneous={},this.requireFail=[]}ee.prototype={defaults:{},set:function(e){return f(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(C(e,"recognizeWith",this))return this;var r=this.simultaneous;return e=Oe(e,this),r[e.id]||(r[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return C(e,"dropRecognizeWith",this)?this:(e=Oe(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(C(e,"requireFailure",this))return this;var r=this.requireFail;return e=Oe(e,this),$(r,e)===-1&&(r.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(C(e,"dropRequireFailure",this))return this;e=Oe(e,this);var r=$(this.requireFail,e);return r>-1&&this.requireFail.splice(r,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var r=this,n=this.state;function l(c){r.manager.emit(c,e)}n<re&&l(r.options.event+wt(n)),l(r.options.event),e.additionalEvent&&l(e.additionalEvent),n>=re&&l(r.options.event+wt(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=J},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(J|Re)))return!1;e++}return!0},recognize:function(e){var r=f({},e);if(!ce(this.options.enable,[this,r])){this.reset(),this.state=J;return}this.state&(K|Ie|J)&&(this.state=Re),this.state=this.process(r),this.state&(j|ue|re|Ie)&&this.tryEmit(r)},process:function(e){},getTouchAction:function(){},reset:function(){}};function wt(e){return e&Ie?"cancel":e&re?"end":e&ue?"move":e&j?"start":""}function At(e){return e==ye?"down":e==Te?"up":e==ve?"left":e==ge?"right":""}function Oe(e,r){var n=r.manager;return n?n.get(e):e}function x(){ee.apply(this,arguments)}U(x,ee,{defaults:{pointers:1},attrTest:function(e){var r=this.options.pointers;return r===0||e.pointers.length===r},process:function(e){var r=this.state,n=e.eventType,l=r&(j|ue),c=this.attrTest(e);return l&&(n&z||!c)?r|Ie:l||c?n&D?r|re:r&j?r|ue:j:J}});function ke(){x.apply(this,arguments),this.pX=null,this.pY=null}U(ke,x,{defaults:{event:"pan",threshold:10,pointers:1,direction:ft},getTouchAction:function(){var e=this.options.direction,r=[];return e&Z&&r.push(be),e&ae&&r.push(Ee),r},directionTest:function(e){var r=this.options,n=!0,l=e.distance,c=e.direction,d=e.deltaX,M=e.deltaY;return c&r.direction||(r.direction&Z?(c=d===0?_e:d<0?ve:ge,n=d!=this.pX,l=Math.abs(e.deltaX)):(c=M===0?_e:M<0?Te:ye,n=M!=this.pY,l=Math.abs(e.deltaY))),e.direction=c,n&&l>r.threshold&&c&r.direction},attrTest:function(e){return x.prototype.attrTest.call(this,e)&&(this.state&j||!(this.state&j)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var r=At(e.direction);r&&(e.additionalEvent=this.options.event+r),this._super.emit.call(this,e)}});function Ze(){x.apply(this,arguments)}U(Ze,x,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[oe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&j)},emit:function(e){if(e.scale!==1){var r=e.scale<1?"in":"out";e.additionalEvent=this.options.event+r}this._super.emit.call(this,e)}});function Je(){ee.apply(this,arguments),this._timer=null,this._input=null}U(Je,ee,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Mt]},process:function(e){var r=this.options,n=e.pointers.length===r.pointers,l=e.distance<r.threshold,c=e.deltaTime>r.time;if(this._input=e,!l||!n||e.eventType&(D|z)&&!c)this.reset();else if(e.eventType&q)this.reset(),this._timer=I(function(){this.state=K,this.tryEmit()},r.time,this);else if(e.eventType&D)return K;return J},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===K&&(e&&e.eventType&D?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=O(),this.manager.emit(this.options.event,this._input)))}});function Qe(){x.apply(this,arguments)}U(Qe,x,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[oe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&j)}});function Ke(){x.apply(this,arguments)}U(Ke,x,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|ae,pointers:1},getTouchAction:function(){return ke.prototype.getTouchAction.call(this)},attrTest:function(e){var r=this.options.direction,n;return r&(Z|ae)?n=e.overallVelocity:r&Z?n=e.overallVelocityX:r&ae&&(n=e.overallVelocityY),this._super.attrTest.call(this,e)&&r&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&m(n)>this.options.velocity&&e.eventType&D},emit:function(e){var r=At(e.offsetDirection);r&&this.manager.emit(this.options.event+r,e),this.manager.emit(this.options.event,e)}});function Le(){ee.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}U(Le,ee,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[je]},process:function(e){var r=this.options,n=e.pointers.length===r.pointers,l=e.distance<r.threshold,c=e.deltaTime<r.time;if(this.reset(),e.eventType&q&&this.count===0)return this.failTimeout();if(l&&c&&n){if(e.eventType!=D)return this.failTimeout();var d=this.pTime?e.timeStamp-this.pTime<r.interval:!0,M=!this.pCenter||we(this.pCenter,e.center)<r.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!M||!d?this.count=1:this.count+=1,this._input=e;var F=this.count%r.taps;if(F===0)return this.hasRequireFailures()?(this._timer=I(function(){this.state=K,this.tryEmit()},r.interval,this),j):K}return J},failTimeout:function(){return this._timer=I(function(){this.state=J},this.options.interval,this),J},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==K&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function te(e,r){return r=r||{},r.recognizers=S(r.recognizers,te.defaults.preset),new et(e,r)}te.VERSION="2.0.7",te.defaults={domEvents:!1,touchAction:_t,enable:!0,inputTarget:null,inputClass:null,preset:[[Qe,{enable:!1}],[Ze,{enable:!1},["rotate"]],[Ke,{direction:Z}],[ke,{direction:Z},["swipe"]],[Le],[Le,{event:"doubletap",taps:2},["tap"]],[Je]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var _r=1,St=2;function et(e,r){this.options=f({},te.defaults,r||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=tr(this),this.touchAction=new xe(this,this.options.touchAction),Nt(this,!0),_(this.options.recognizers,function(n){var l=this.add(new n[0](n[1]));n[2]&&l.recognizeWith(n[2]),n[3]&&l.requireFailure(n[3])},this)}et.prototype={set:function(e){return f(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?St:_r},recognize:function(e){var r=this.session;if(!r.stopped){this.touchAction.preventDefaults(e);var n,l=this.recognizers,c=r.curRecognizer;(!c||c&&c.state&K)&&(c=r.curRecognizer=null);for(var d=0;d<l.length;)n=l[d],r.stopped!==St&&(!c||n==c||n.canRecognizeWith(c))?n.recognize(e):n.reset(),!c&&n.state&(j|ue|re)&&(c=r.curRecognizer=n),d++}},get:function(e){if(e instanceof ee)return e;for(var r=this.recognizers,n=0;n<r.length;n++)if(r[n].options.event==e)return r[n];return null},add:function(e){if(C(e,"add",this))return this;var r=this.get(e.options.event);return r&&this.remove(r),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(C(e,"remove",this))return this;if(e=this.get(e),e){var r=this.recognizers,n=$(r,e);n!==-1&&(r.splice(n,1),this.touchAction.update())}return this},on:function(e,r){if(e!==s&&r!==s){var n=this.handlers;return _(R(e),function(l){n[l]=n[l]||[],n[l].push(r)}),this}},off:function(e,r){if(e!==s){var n=this.handlers;return _(R(e),function(l){r?n[l]&&n[l].splice($(n[l],r),1):delete n[l]}),this}},emit:function(e,r){this.options.domEvents&&Mr(e,r);var n=this.handlers[e]&&this.handlers[e].slice();if(!(!n||!n.length)){r.type=e,r.preventDefault=function(){r.srcEvent.preventDefault()};for(var l=0;l<n.length;)n[l](r),l++}},destroy:function(){this.element&&Nt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Nt(e,r){var n=e.element;if(n.style){var l;_(e.options.cssProps,function(c,d){l=B(n.style,d),r?(e.oldCssProps[l]=n.style[l],n.style[l]=c):n.style[l]=e.oldCssProps[l]||""}),r||(e.oldCssProps={})}}function Mr(e,r){var n=a.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=r,r.target.dispatchEvent(n)}f(te,{INPUT_START:q,INPUT_MOVE:se,INPUT_END:D,INPUT_CANCEL:z,STATE_POSSIBLE:Re,STATE_BEGAN:j,STATE_CHANGED:ue,STATE_ENDED:re,STATE_RECOGNIZED:K,STATE_CANCELLED:Ie,STATE_FAILED:J,DIRECTION_NONE:_e,DIRECTION_LEFT:ve,DIRECTION_RIGHT:ge,DIRECTION_UP:Te,DIRECTION_DOWN:ye,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:ae,DIRECTION_ALL:ft,Manager:et,Input:V,TouchAction:xe,TouchInput:Se,MouseInput:Ae,PointerEventInput:Ge,TouchMouseInput:Ve,SingleTouchInput:Et,Recognizer:ee,AttrRecognizer:x,Tap:Le,Pan:ke,Swipe:Ke,Pinch:Ze,Rotate:Qe,Press:Je,on:b,off:y,each:_,merge:w,extend:N,assign:f,inherit:U,bindFn:he,prefixed:B});var wr=typeof i<"u"?i:typeof self<"u"?self:{};wr.Hammer=te,typeof s=="function"&&s.amd?s(function(){return te}):t.exports?t.exports=te:i[o]=te})(window,document,"Hammer")})(Ht);var Rr=Ht.exports;const Ot=Ut(Rr);var lt=(t,i,a)=>{if(!i.has(t))throw TypeError("Cannot "+a)},fe=(t,i,a)=>(lt(t,i,"read from private field"),a?a.call(t):i.get(t)),le=(t,i,a)=>{if(i.has(t))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(t):i.set(t,a)},de=(t,i,a,o)=>(lt(t,i,"write to private field"),o?o.call(t,a):i.set(t,a),a),Fe=(t,i,a)=>(lt(t,i,"access private method"),a),ie,me,We,rt,Ft,nt,Wt,it,Yt,st,qt;class Or{constructor(i={}){le(this,rt),le(this,nt),le(this,it),le(this,st),le(this,ie,void 0),le(this,me,-1),le(this,We,50);const{decimalPlaces:a=-1,defaultQuantity:o=50}=i;this.setDecimalPlaces(a),this.setDefaultQuantity(o)}setDecimalPlaces(i=-1){if(typeof i!="number"||i%1!==0||i<-1)throw new TypeError("The argument 'decimalPlaces' must be a positive integer or -1.");de(this,me,i)}setDefaultQuantity(i){if(typeof i!="number"||i%1!==0||i<=0)throw new TypeError("The argument 'defaultQuantity' must be a positive integer.");de(this,We,i)}setPath(i,...a){switch(i){case"LINE":de(this,ie,Fe(this,rt,Ft).call(this,a[0],a[1]));break;case"TWO_ORDER_BEZIER":de(this,ie,Fe(this,nt,Wt).call(this,a[0],a[1],a[2]));break;case"THREE_ORDER_BEZIER":de(this,ie,Fe(this,it,Yt).call(this,a[0],a[1],a[2],a[3]));break;case"ARC":de(this,ie,Fe(this,st,qt).call(this,a[0],a[1],a[2],a[3],a[4],a[5]));break;default:throw new TypeError(`The argument 'type' expact 'LINE', 'TWO_ORDER_BEZIER', 'THREE_ORDER_BEZIER', or 'ARC', but got '${i}'`)}return this}getPoint(i=0){if(!fe(this,ie))throw new Error("Please set path first.");if(i>1||i<0)throw new RangeError("The argument 't' must be between 0 and 1.");let{x:a,y:o}=fe(this,ie).call(this,i);return fe(this,me)>-1&&(a=Number(a.toFixed(fe(this,me))),o=Number(o.toFixed(fe(this,me)))),{x:a,y:o}}getPoints(i){if(i||(i=fe(this,We)),typeof i!="number"||i%1!==0||i<=0)throw new TypeError("The argument 'quantity' must be a positive integer.");const a=[];for(let o=0;o<i;o++)a.push(this.getPoint(o/(i-1)));return a}}ie=new WeakMap,me=new WeakMap,We=new WeakMap,rt=new WeakSet,Ft=function(t,i){const{x:a,y:o}=t,{x:s,y:h}=i;return p=>({x:a+(s-a)*p,y:o+(h-o)*p})},nt=new WeakSet,Wt=function(t,i,a){const{x:o,y:s}=t,{x:h,y:p}=i,{x:T,y:u}=a;return m=>({x:Math.pow(1-m,2)*o+2*m*(1-m)*h+Math.pow(m,2)*T,y:Math.pow(1-m,2)*s+2*m*(1-m)*p+Math.pow(m,2)*u})},it=new WeakSet,Yt=function(t,i,a,o){const{x:s,y:h}=t,{x:p,y:T}=i,{x:u,y:m}=a,{x:O,y:I}=o;return C=>({x:s*Math.pow(1-C,3)+3*p*C*Math.pow(1-C,2)+3*u*Math.pow(C,2)*(1-C)+O*Math.pow(C,3),y:h*Math.pow(1-C,3)+3*T*C*Math.pow(1-C,2)+3*m*Math.pow(C,2)*(1-C)+I*Math.pow(C,3)})},st=new WeakSet,qt=function(t,i,a,o,s,h=!1){const p=2*Math.PI;if(h&&([o,s]=[s,o]),s-o>=p)s=o+p;else if(o!==s)if((o-s)%p===0)s=o;else for(o=o%p;s>o+p;)s-=p;const T=o>s?p-o+s:s-o;return u=>{h&&(u=1-u);const m=T*u+o;return{x:t+Math.cos(m)*a,y:i+Math.sin(m)*a}}};var Ye=(t=>(t[t.DEFAULT=0]="DEFAULT",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT",t))(Ye||{});function kr(t,i,a,o){const s=a-t,h=o-i;return Math.atan2(h,s)}function kt(t,i,a,o,s=[255,255,255],h=[255,245,196]){t.beginPath(),t.save(),t.translate(i,a);const[p,T,u]=s,m=t.createRadialGradient(0,0,o/2,0,0,o);m.addColorStop(0,`rgba(${p}, ${T}, ${u}, 0.5)`),m.addColorStop(1,`rgba(${p}, ${T}, ${u}, 0.1)`),t.arc(0,0,o,0,Math.PI*2),t.fillStyle=m,t.fill(),t.save(),t.globalCompositeOperation="destination-out",t.beginPath(),t.ellipse(o*.05,o*.05,o*.82,o*.95,Math.PI/4,0,Math.PI*2),t.fillStyle="rgba(0, 0, 0, 1)",t.fill(),t.restore(),t.save(),t.beginPath(),t.arc(0,0,o,0,Math.PI*2),t.shadowColor=`rgba(${h[0]}, ${h[1]}, ${h[2]}, 1)`,t.shadowBlur=20,t.shadowOffsetX=o/8,t.shadowOffsetY=o/8,t.strokeStyle=`rgba(${p}, ${T}, ${u}, 0.5)`,t.lineWidth=2,t.stroke(),t.restore(),t.beginPath(),t.ellipse(-o*.9*Math.cos(Math.PI/3),-o*.9*Math.sin(Math.PI/3),o*.1,o*.05,Math.PI*.8,0,Math.PI*2),t.fillStyle=`rgba(${p}, ${T}, ${u}, 0.75)`,t.ellipse(-o*.9*Math.cos(Math.PI*1.95),-o*.9*Math.sin(Math.PI*1.95),o*.06,o*.03,Math.PI*.6,0,Math.PI*2),t.fillStyle=`rgba(${p}, ${T}, ${u}, 0.5)`,t.fill(),t.restore()}function Lr(t,i,a,o,s,h=[255,255,255]){switch(t.save(),t.beginPath(),s){case 1:t.translate(i,a-o*.9),t.rotate(Math.PI/2);break;case 4:t.translate(i+o*.9,a),t.rotate(Math.PI);break;case 2:t.translate(i,a+o*.9),t.rotate(Math.PI*1.5);break;case 3:default:t.translate(i-o*.9,a);break}t.lineCap="round",t.lineJoin="round",t.moveTo(0,0),t.lineTo(o*.3*Math.cos(Math.PI/6),o*.3*Math.sin(Math.PI/6)),t.lineTo(o*.2,0),t.scale(1,-1),t.moveTo(0,0),t.lineTo(o*.3*Math.cos(Math.PI/6),o*.3*Math.sin(Math.PI/6)),t.lineTo(o*.2,0),t.lineWidth=2;const p=t.createLinearGradient(0,0,o*.3,0),[T,u,m]=h;p.addColorStop(0,`rgba(${T}, ${u}, ${m}, 0.8)`),p.addColorStop(1,`rgba(${T}, ${u}, ${m}, 0.3)`),t.fillStyle=p,t.strokeStyle=p,t.stroke(),t.fill(),t.restore()}function Dr(t,i,a){t.save(),t.translate(i.baseCenter.x,i.baseCenter.y);const o=i.baseRadius,s={x:Math.cos(a-Math.PI/8)*o,y:Math.sin(a-Math.PI/8)*o},h={x:Math.cos(a)*(o+4),y:Math.sin(a)*(o+4)},p={x:Math.cos(a)*(o+16),y:Math.sin(a)*(o+16)},[T,u,m]=i.edgeLightColor;t.beginPath(),t.shadowColor=`rgba(${T}, ${u}, ${m}, 1)`,t.shadowBlur=10,t.arc(0,0,o,a-Math.PI/8,a+Math.PI/8),t.quadraticCurveTo(h.x,h.y,p.x,p.y),t.quadraticCurveTo(h.x,h.y,s.x,s.y),t.fillStyle=`rgba(${T}, ${u}, ${m}, 1)`,t.fill();const O=a-Math.PI/4,I=a+Math.PI/4,C=new Or;let _=Math.floor(i.baseRadius*.8);_%2===0&&(_+=1);const v=C.setPath("ARC",0,0,o,O,I).getPoints(_);for(let f=0;f<_/2;f++){const N=v[f],w=v[v.length-1-f];t.save(),t.shadowColor=`rgba(${T}, ${u}, ${m}, 1)`,t.shadowBlur=10,t.fillStyle=`rgba(${T}, ${u}, ${m}, 0.5)`,t.beginPath(),t.arc(N.x,N.y,f*.12,0,2*Math.PI),t.fill(),t.beginPath(),t.arc(w.x,w.y,f*.12,0,2*Math.PI),t.fill(),t.restore()}t.restore()}function Ce(t,i){t.clearRect(0,0,t.canvas.width,t.canvas.height),kt(t,i.baseCenter.x,i.baseCenter.y,i.baseRadius,i.baseColor),kt(t,i.handleCenter.x,i.handleCenter.y,i.handleRadius,i.handleColor),[1,4,2,3].forEach(o=>{const s=i.currentDirection===o?i.handleColor:i.baseColor;Lr(t,i.baseCenter.x,i.baseCenter.y,i.baseRadius,o,s)})}const Ur=t=>{const i=Object.assign({width:400,height:300,baseRadius:80,handleRadius:40,baseColor:[255,255,255],handleColor:[245,255,196],edgeLightColor:[245,255,196],onDirectionChange:()=>{}},t),a=ot(i.width,i.height),o=a.getContext("2d");let s=0;const h={width:a.width,height:a.height,get currentDirection(){return s},set currentDirection(I){s=I,i.onDirectionChange(I)},isDragging:!1,baseCenter:{x:i.width/2,y:i.height/2},handleCenter:{x:i.width/2,y:i.height/2},baseRadius:i.baseRadius,handleRadius:i.handleRadius,baseColor:i.baseColor,handleColor:i.handleColor,edgeLightColor:i.edgeLightColor};function p(I,C){const _=I-h.baseCenter.x,v=C-h.baseCenter.y,f=Math.sqrt(_*_+v*v);f>h.baseRadius-h.handleRadius?(h.handleCenter.x=h.baseCenter.x+_/f*(h.baseRadius-h.handleRadius),h.handleCenter.y=h.baseCenter.y+v/f*(h.baseRadius-h.handleRadius)):(h.handleCenter.x=I,h.handleCenter.y=C)}const T=I=>{h.currentDirection=I,Ce(o,h)},u=new Ot(a);u.get("pan").set({direction:Ot.DIRECTION_ALL}),u.on("panstart",I=>{const C=a.getBoundingClientRect(),_=I.center.x-C.left,v=I.center.y-C.top,f=_-h.handleCenter.x,N=v-h.handleCenter.y;Math.sqrt(f*f+N*N)<=h.handleRadius&&(h.isDragging=!0,p(_,v),Ce(o,h))}),u.on("panmove",I=>{if(h.isDragging){const C=a.getBoundingClientRect(),_=I.center.x-C.left,v=I.center.y-C.top;p(_,v),Ce(o,h);const f=kr(0,0,_-h.baseCenter.x,v-h.baseCenter.y);Dr(o,h,f),f>=-Math.PI/4&&f<Math.PI/4?h.currentDirection=4:f>=Math.PI/4&&f<Math.PI*3/4?h.currentDirection=2:f>=Math.PI*3/4&&f<=Math.PI||f>=-Math.PI&&f<=-Math.PI*3/4?h.currentDirection=3:f>=-Math.PI*3/4&&f<-Math.PI/4&&(h.currentDirection=1)}}),u.on("panend",()=>{h.isDragging&&(Object.assign(h,{isDragging:!1,handleCenter:{x:h.baseCenter.x,y:h.baseCenter.y},currentDirection:0}),Ce(o,h),console.log("Rocker Released"))});const m=I=>{switch(I.key){case"ArrowLeft":T(3);break;case"ArrowRight":T(4);break;case"ArrowUp":T(1);break;case"ArrowDown":T(2);break}};return document.addEventListener("keydown",m),Ce(o,h),{rocker:a,destroyRocker:()=>{document.removeEventListener("keydown",m),u.destroy(),a.remove()}}},Hr="GAME_OVER",Fr="DIRECTION_CHANGE",qe="STATUS_CHANGE",Xt="LENGTH_CHANGE",$t="DRAW",ht="EXIT",zt="RESTART",Bt=(t,i)=>{const a=typeof t=="string"?document.querySelector(t):t;if(!a||!("innerHTML"in a))throw new TypeError(`'el' expect a selector or a HTMLElement, but got a '${t}'`);const o=document.createElement("div");o.classList.add("home"),o.innerHTML=`
    <div class="background"></div>
    <div class="flowing-gradient"></div>
    <div class="particles" id="J_particles"></div>
    <div class="content">
      <h1 class="title">贪吃蛇</h1>
      <button class="btn btn-start" id="J_btn_start">开始游戏</button>
      <button class="btn btn-back" id="J_btn_back">返回首页</button>
    </div>
  `;const s=()=>{i()},h=()=>{window.location.href="/mini-games"};return{mount:()=>{a.appendChild(o);for(let u=0;u<100;u++){const m=document.createElement("span");m.style.left=`${Math.random()*100}vw`,m.style.top=`${Math.random()*100}vh`,m.style.animationDelay=`${Math.random()*5}s`,document.querySelector("#J_particles").appendChild(m)}document.querySelector("#J_btn_start").addEventListener("click",s),document.querySelector("#J_btn_back").addEventListener("click",h)},unmount:()=>{document.querySelector("#J_btn_start").removeEventListener("click",s),document.querySelector("#J_btn_back").removeEventListener("click",h),a.removeChild(o)}}},Wr=t=>{const{width:i,height:a}=t.mainAreaSize,o=ot(i,a),s=o.getContext("2d"),h="#000",p="#fff",T="#f40",u="#00ff88",m=t.rows,O=t.columns,I={top:(a-m*L)/2,right:(i-O*L)/2,bottom:(a-m*L)/2,left:(i-O*L)/2},C=()=>{for(let S=0;S<m;S++)for(let b=0;b<O;b++)s.strokeStyle="#e1e1e1",s.strokeRect(b*L,S*L,L,L)},_=S=>{const b=S[0],y=S.slice(1,-1),g=S[S.length-1];v(b,Ue(b,y[0])),y.forEach((P,R)=>{f(P,Ue(R===0?b:y[R-1],P),Ue(R===y.length-1?g:y[R+1],P))}),N(g,Ue(g,y.at(-1)))},v=(S,b)=>{s.save();const y=L,g=L;switch(s.translate(S.x*y+y/2,S.y*g+g/2),b){case E.top:s.rotate(-Math.PI/2);break;case E.right:break;case E.bottom:s.rotate(Math.PI/2);break;case E.left:s.rotate(Math.PI);break}s.beginPath(),s.moveTo(-y/2,-g/4),s.bezierCurveTo(y/2,-g*.8,y/2,g*.8,-y/2,g/4),s.fillStyle=h,s.fill(),s.beginPath(),s.arc(-y*.1,-g*.2,2,0,Math.PI*2),s.fillStyle=p,s.fill(),s.beginPath(),s.arc(-y*.1,g*.2,2,0,Math.PI*2),s.fillStyle=p,s.fill(),s.beginPath(),s.moveTo(y*.1,0),s.bezierCurveTo(y*.25,g*.2,y*.25,-g*.2,y*.5,0),s.strokeStyle=T,s.stroke(),s.restore()},f=(S,b,y)=>{s.save();const g=L,P=L;s.translate(S.x*g+g/2,S.y*P+P/2),s.beginPath();let R={x:0,y:0},$=null,W={x:0,y:0},H={x:0,y:0},B=null,G={x:0,y:0};switch(b){case E.top:R={x:-g/4,y:-P/2},H={x:g/4,y:-P/2},y===E.right&&(R={x:g/4,y:-P/2},H={x:-g/4,y:-P/2});break;case E.right:R={x:g/2,y:-P/4},H={x:g/2,y:P/4},y===E.top&&(R={x:g/2,y:P/4},H={x:g/2,y:-P/4});break;case E.bottom:R={x:-g/4,y:P/2},H={x:g/4,y:P/2},y===E.left&&(R={x:g/4,y:P/2},H={x:-g/4,y:P/2});break;case E.left:R={x:-g/2,y:-P/4},H={x:-g/2,y:P/4},y===E.bottom&&(R={x:-g/2,y:P/4},H={x:-g/2,y:-P/4});break}switch(y){case E.top:W={x:-g/4,y:-P/2},$=ne(b,y,R,W),G={x:g/4,y:-P/2},B=ne(b,y,H,G);break;case E.right:W={x:g/2,y:-P/4},$=ne(b,y,R,W),G={x:g/2,y:P/4},B=ne(b,y,H,G);break;case E.bottom:W={x:-g/4,y:P/2},$=ne(b,y,R,W),G={x:g/4,y:P/2},B=ne(b,y,H,G);break;case E.left:W={x:-g/2,y:-P/4},$=ne(b,y,R,W),G={x:-g/2,y:P/4},B=ne(b,y,H,G);break}s.beginPath(),s.lineWidth=1,s.moveTo(R.x,R.y),$?s.quadraticCurveTo($.x,$.y,W.x,W.y):s.lineTo(W.x,W.y),s.lineTo(G.x,G.y),B?s.quadraticCurveTo(B.x,B.y,H.x,H.y):s.lineTo(H.x,H.y),s.fillStyle=h,s.fill(),s.restore()},N=(S,b)=>{s.save();const y=L,g=L;switch(s.translate(S.x*y+y/2,S.y*g+g/2),b){case E.top:s.scale(Math.random()>.5?1:-1,-1);break;case E.right:s.rotate(Math.PI/2),s.scale(Math.random()>.5?1:-1,-1);break;case E.bottom:s.scale(Math.random()>.5?1:-1,1);break;case E.left:s.rotate(Math.PI/2),s.scale(Math.random()>.5?1:-1,1);break}s.beginPath(),s.fillStyle=h,s.moveTo(-y/4,-g/2),s.quadraticCurveTo(-y/2,g/2,y/2,g/2),s.quadraticCurveTo(-y/4,g/4,y/4,-g/2),s.fill(),s.restore()},w=S=>{s.save(),s.translate(S.x*L+L/2,S.y*L+L/2),s.fillStyle=u,s.beginPath(),s.shadowBlur=10,s.shadowColor=u,s.arc(0,0,L/4,0,Math.PI*2),s.fill(),s.restore()},U=()=>{s.clearRect(0,0,i,a),s.save(),s.translate(I.left,I.top),C(),_(t.snake),w(t.food),s.restore()};return{mount:S=>{S.appendChild(o),t.emitter.on($t,U)},unmount:()=>{o.remove()},draw:U}},Yr=t=>{const i=t.mainAreaSize.width*.5,a=t.footerAreaSize.height,o=ot(i,a),s=o.getContext("2d"),h=[{name:"ctrl",text:"暂停游戏",cx:i/4,cy:a/4,width:Math.max(80,i/6),height:a/4,status:"default"},{name:"esc",text:"不玩了",cx:i/4,cy:a*3/4,width:Math.max(80,i/6),height:a/4,status:"default"}],p=v=>{s.save(),s.beginPath(),s.translate(v.cx,v.cy),s.roundRect?s.roundRect(-v.width/2,-v.height/2,v.width,v.height,a/16):Nr(s,-v.width/2,-v.height/2,v.width,v.height,a/16),s.strokeStyle=v.status==="hover"?"transparent":"#333",s.stroke();const f=s.createLinearGradient(0,0,v.width,v.height);f.addColorStop(0,"#00ff88"),f.addColorStop(1,"#0088ff"),s.fillStyle=v.status==="hover"?f:"transparent",s.fill(),s.restore(),Pe(s,v.name==="ctrl"?t.status===k.paused?"继续游戏":t.status===k.finished?"再来一局":"暂停游戏":v.text,{x:v.cx,y:v.cy,fontSize:v.height*.4,color:v.status==="hover"?"#fff":"#333",textAlign:"center",textBaseline:"middle"})},T=()=>{h.forEach(v=>{p(v)})},u=(v,f)=>{Pe(s,"状态：",{x:i*3/4,y:a/4,fontSize:a/10,color:"#333",textAlign:"right",textBaseline:"middle"}),Pe(s,v===k.paused?"暂停中":v===k.finished?"已结束":"游戏中",{x:i*3/4,y:a/4,fontSize:Math.min(14,a/8),color:v===k.paused?"#ff0":v===k.finished?"#f40":"#0088ff",textAlign:"left",textBaseline:"middle"}),Pe(s,"长度：",{x:i*3/4,y:a*3/4,fontSize:a/10,color:"#333",textAlign:"right",textBaseline:"middle"}),Pe(s,`${f}`,{x:i*3/4,y:a*3/4,fontSize:Math.min(14,a/8),color:"#ff0088",textAlign:"left",textBaseline:"middle"})},m=()=>{s.clearRect(0,0,i,a),T(),u(t.status,t.length)},O=v=>{const f=v.clientX-o.offsetLeft,N=v.clientY-o.offsetTop;for(const w of h){if(f>w.cx-w.width/2&&f<w.cx+w.width/2&&N>w.cy-w.height/2&&N<w.cy+w.height/2){w.status="hover",o.style.cursor="pointer";break}w.status="default",o.style.cursor="default"}m()},I=v=>{const f=v.clientX-o.offsetLeft,N=v.clientY-o.offsetTop;for(const w of h)if(f>w.cx-w.width/2&&f<w.cx+w.width/2&&N>w.cy-w.height/2&&N<w.cy+w.height/2){console.log(w.name),w.name==="ctrl"?t.status===k.finished?t.emitter.emit(zt):t.emitter.emit(qe,t.status===k.paused?k.playing:k.paused):w.name==="esc"&&t.emitter.emit(ht);break}},C=v=>{v.appendChild(o),document.addEventListener("mousemove",O),document.addEventListener("click",I)};return t.emitter.on(qe,m),t.emitter.on(Xt,m),{mount:C,unmount:()=>{o.remove()},render:m}},qr=t=>{const i=t.footerAreaSize.width*.5,a=t.footerAreaSize.height,o=Math.min(i,a),{rocker:s,destroyRocker:h}=Ur({width:i,height:a,baseRadius:o*.4,handleRadius:o*.2,baseColor:[255,255,255],handleColor:[0,255,136],edgeLightColor:[0,255,136],onDirectionChange:u=>{t.direction=u===Ye.UP?A.up:u===Ye.RIGHT?A.right:u===Ye.DOWN?A.down:A.left}});return{mount:u=>{u.appendChild(s)},unmount:()=>{h()}}};function Pe(t,i,a={}){const{x:o,y:s,fontSize:h,fontFamily:p,fontWeight:T,color:u,textAlign:m,textBaseline:O}=a;t.save(),t.font=`${T??"normal"} ${h??16}px ${p??"Arial"}`,t.fillStyle=u??"#000",t.textAlign=m??"center",t.textBaseline=O??"middle",t.fillText(i,o??0,s??0),t.restore()}const $e=class $e{constructor(){De(this,"_maxListeners");De(this,"_events");this._events=Object.create(null)}get events(){return this._events}get eventNames(){return Object.keys(this._events)}get maxListener(){return this._maxListeners?this._maxListeners:$e.defaultMaxListener}set maxListener(i){this._maxListeners=i}on(i,a){this._events[i]?this._events[i].length>=this.maxListener?console.warn("监听的事件不能超过设置的最大监听数。"):this._events[i].push(a):this._events[i]=[a]}once(i,a){const o=(...s)=>{a(...s),this.off(i,o)};o.listen=a,this.on(i,o)}emit(i,...a){this._events[i]&&this._events[i].forEach(o=>{o.call(this,...a)})}off(i,a){this._events[i]&&(this._events[i]=this._events[i].filter(o=>a!==o&&a!==o.listen))}clear(){this._events=Object.create(null)}};De($e,"defaultMaxListener",10);let at=$e;var Gt="Expected a function",Lt=0/0,Xr="[object Symbol]",$r=/^\s+|\s+$/g,zr=/^[-+]0x[0-9a-f]+$/i,Br=/^0b[01]+$/i,Gr=/^0o[0-7]+$/i,Vr=parseInt,jr=typeof He=="object"&&He&&He.Object===Object&&He,xr=typeof self=="object"&&self&&self.Object===Object&&self,Zr=jr||xr||Function("return this")(),Jr=Object.prototype,Qr=Jr.toString,Kr=Math.max,en=Math.min,tt=function(){return Zr.Date.now()};function tn(t,i,a){var o,s,h,p,T,u,m=0,O=!1,I=!1,C=!0;if(typeof t!="function")throw new TypeError(Gt);i=Dt(i)||0,Xe(a)&&(O=!!a.leading,I="maxWait"in a,h=I?Kr(Dt(a.maxWait)||0,i):h,C="trailing"in a?!!a.trailing:C);function _(b){var y=o,g=s;return o=s=void 0,m=b,p=t.apply(g,y),p}function v(b){return m=b,T=setTimeout(w,i),O?_(b):p}function f(b){var y=b-u,g=b-m,P=i-y;return I?en(P,h-g):P}function N(b){var y=b-u,g=b-m;return u===void 0||y>=i||y<0||I&&g>=h}function w(){var b=tt();if(N(b))return U(b);T=setTimeout(w,f(b))}function U(b){return T=void 0,C&&o?_(b):(o=s=void 0,p)}function he(){T!==void 0&&clearTimeout(T),m=0,o=u=s=T=void 0}function ce(){return T===void 0?p:U(tt())}function S(){var b=tt(),y=N(b);if(o=arguments,s=this,u=b,y){if(T===void 0)return v(u);if(I)return T=setTimeout(w,i),_(u)}return T===void 0&&(T=setTimeout(w,i)),p}return S.cancel=he,S.flush=ce,S}function rn(t,i,a){var o=!0,s=!0;if(typeof t!="function")throw new TypeError(Gt);return Xe(a)&&(o="leading"in a?!!a.leading:o,s="trailing"in a?!!a.trailing:s),tn(t,i,{leading:o,maxWait:i,trailing:s})}function Xe(t){var i=typeof t;return!!t&&(i=="object"||i=="function")}function nn(t){return!!t&&typeof t=="object"}function sn(t){return typeof t=="symbol"||nn(t)&&Qr.call(t)==Xr}function Dt(t){if(typeof t=="number")return t;if(sn(t))return Lt;if(Xe(t)){var i=typeof t.valueOf=="function"?t.valueOf():t;t=Xe(i)?i+"":i}if(typeof t!="string")return t===0?t:+t;t=t.replace($r,"");var a=Br.test(t);return a||Gr.test(t)?Vr(t.slice(2),a?2:8):zr.test(t)?Lt:+t}var an=rn;const on=Ut(an),ln=()=>{let t=k.finished,i=A.right;const a=new at,{innerWidth:o,innerHeight:s}=window,h={width:o,height:s*.8},p={width:o,height:s*.2};let T=performance.now();return{columns:Math.floor(h.width/L),rows:Math.floor(h.height/L),mainAreaSize:h,footerAreaSize:p,speed:100,snake:[],food:{x:0,y:0},get status(){return t},set status(u){t=u,a.emit(qe,u)},get direction(){return i},set direction(u){if(t!==k.playing)return;const m=performance.now();if(!(m-T<=this.speed)){switch(T=m,i){case A.up:u!==A.down&&(i=u);break;case A.right:u!==A.left&&(i=u);break;case A.down:u!==A.up&&(i=u);break;case A.left:u!==A.right&&(i=u);break}a.emit(Fr,u)}},get length(){return this.snake.length},startTime:0,emitter:a}},hn=t=>{const{columns:i,rows:a}=t;let o=0;const s=()=>{document.addEventListener("keydown",T,!1),t.emitter.on(qe,()=>{t.status===k.paused||t.status===k.finished?cancelAnimationFrame(o):t.status===k.playing&&m()}),t.emitter.on(zt,()=>{h()}),h()},h=()=>{t.snake=[{part:"HEAD",x:Math.floor(i/2),y:Math.floor(a/2)},{part:"BODY",x:Math.floor(i/2)-1,y:Math.floor(a/2)},{part:"TAIL",x:Math.floor(i/2)-2,y:Math.floor(a/2)}],t.food=p(),t.direction=A.right,t.status=k.playing,t.startTime=performance.now()},p=()=>{const I=t.snake,{columns:C,rows:_}=t,v=Rt(0,C-1),f=Rt(0,_-1);return t.snake.length>=C*_?(t.emitter.emit(Hr,t.snake.length),{x:0,y:0}):I.some(N=>N.x===v&&N.y===f)?p():{x:v,y:f}},T=on(I=>{switch(I.code){case"ArrowUp":case"KeyW":t.direction!==A.down&&(t.direction=A.up);break;case"ArrowRight":case"KeyD":t.direction!==A.left&&(t.direction=A.right);break;case"ArrowDown":case"KeyS":t.direction!==A.up&&(t.direction=A.down);break;case"ArrowLeft":case"KeyA":t.direction!==A.right&&(t.direction=A.left);break;case"Space":if(t.status===k.finished)return;t.status===k.paused?(t.status=k.playing,m()):t.status=k.paused;break;case"Escape":t.emitter.emit(ht);break}},t.speed),u=()=>{const I=t.food,{columns:C,rows:_}=t,v=t.snake[0],f={...v};switch(t.direction){case A.up:f.y-=1;break;case A.right:f.x+=1;break;case A.down:f.y+=1;break;case A.left:f.x-=1;break}if(f.x<0||f.x>=C||f.y<0||f.y>=_)switch(t.direction){case A.left:f.x=C-1;break;case A.right:f.x=0;break;case A.up:f.y=_-1;break;case A.down:f.y=0;break}if(t.snake.some(N=>N.x===f.x&&N.y===f.y)){t.status=k.finished;return}if(f.x===I.x&&f.y===I.y){v.part="BODY",t.snake.unshift(f),t.food=p(),t.emitter.emit(Xt,t.snake.length);return}v.part="BODY",t.snake.pop(),t.snake.unshift(f),t.snake.at(-1).part="TAIL"},m=()=>{if(t.status!==k.playing){cancelAnimationFrame(o);return}const I=performance.now();I-t.startTime>=t.speed&&(u(),t.startTime=I),t.emitter.emit($t),o=requestAnimationFrame(m)};return{init:s,destroy:()=>{cancelAnimationFrame(o),document.removeEventListener("keydown",T,!1)}}};const Vt=()=>{const t=ln(),i=t.mainAreaSize,a=t.footerAreaSize,o=document.querySelector("#app"),s=document.createElement("footer");s.style.cssText=`
    display: flex;
    align-items: center;
    width: ${i.width}px;
    height: ${a.height}px;
  `;const h=Wr(t),p=qr(t),T=Yr(t);h.mount(o),p.mount(s),T.mount(s),o.appendChild(s),console.log(h,p,T);const{init:u,destroy:m}=hn(t);u(),t.emitter.on(ht,()=>{m(),p.unmount(),T.unmount(),h.unmount(),o.removeChild(s);const O=Bt("#app",()=>{O.unmount(),Vt()});O.mount()})};window.addEventListener("DOMContentLoaded",()=>{const t=Bt("#app",()=>{t.unmount(),Vt()});t.mount()});
